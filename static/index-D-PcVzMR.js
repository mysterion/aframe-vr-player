(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function v(e){isNaN(e)&&(e=0);var i=new Date(null);return i.setSeconds(e),i.toISOString().substr(11,8)}AFRAME.registerComponent("timeline-listen",{init:function(){let e=document.getElementById("timeline"),i=document.getElementById("video"),t=document.getElementById("seek");this.video=i,this.seek=t,this.timeline=e,this.hoverEl=document.getElementById("hover"),this.hoverTextEl=document.getElementById("hover-text"),e.addEventListener("click",function(o){var r=e.getAttribute("geometry").width,s=o.detail.intersection.uv.x,l=s*r-r/2;i.currentTime=(s*i.duration).toFixed(2);let{x:c,y:u,z:a}=t.getAttribute("position");t.setAttribute("position",`${l} ${u} ${a}`)}),e.addEventListener("raycaster-intersected",o=>{this.raycaster=o.detail.el,this.hoverEl.setAttribute("visible",!0)}),e.addEventListener("raycaster-intersected-cleared",o=>{this.raycaster=null,this.hoverEl.setAttribute("visible",!1)})},tick:function(){var u,a,d;if(!this.raycaster)return;let e=this.raycaster.components.raycaster.getIntersection(this.timeline);if(!e||e.point.x===((u=this.previousIntersection)==null?void 0:u.x)&&e.point.y===((a=this.previousIntersection)==null?void 0:a.y)&&e.point.z===((d=this.previousIntersection)==null?void 0:d.z))return;let i=e.uv.x,t=timeline.getAttribute("geometry").width,o=i*t-t/2,r=Math.floor(i*video.duration),{x:s,y:l,z:c}=this.hoverEl.getAttribute("position");this.hoverEl.setAttribute("position",`${o} ${l} ${c}`),this.hoverTextEl.setAttribute("value",v(r)),this.previousIntersection=e.point}});AFRAME.registerComponent("setup",{init:function(){z()}});AFRAME.registerComponent("stereosphere",{schema:{eye:{type:"string",default:"left"},mode:{type:"string",default:"180SbsEq"},side:{type:"string",default:"left"}},update:function(e){let i=this.el.object3D.children[0],t=this.data;if(t.mode==="180SbsEq"){let o=this.el.getAttribute("geometry"),r=new THREE.SphereGeometry(o.radius||100,o.segmentsWidth||32,o.segmentsHeight||32,Math.PI,Math.PI,0,Math.PI),s={repeat:{x:-.5,y:1},offset:{x:.5,y:0}};t.side==="right"&&(s.offset.x+=.5);let l=r.attributes.uv;for(let c=0;c<l.count;c++){const u=l.getX(c),a=l.getY(c);l.setXY(c,u*s.repeat.x+s.offset.x,a*s.repeat.y+s.offset.y)}l.needsUpdate=!0,i.geometry=r}else if(t.mode==="180SbsFish"){let o=this.el.getAttribute("geometry"),r=new THREE.SphereGeometry(o.radius||100,o.segmentsWidth||32,o.segmentsHeight||32),s={repeat:{x:.5,y:1},offset:{x:0,y:0}};t.side==="right"&&(s.offset.x+=.5),r.rotateX(-Math.PI/2),r.rotateY(Math.PI);let l=r.attributes.uv;for(let c=0;c<l.count;c++){const u=l.getX(c),a=l.getY(c),d=2*Math.PI*u,f=Math.PI*a/Math.PI,h=.5+f*Math.cos(d),E=.5+f*Math.sin(d);l.setXY(c,h*s.repeat.x+s.offset.x,E*s.repeat.y+s.offset.y)}l.needsUpdate=!0,i.geometry=r}t.eye==="left"?i.layers.set(1):t.eye==="right"?i.layers.set(2):i.layers.set(0)}});AFRAME.registerComponent("stereocam",{schema:{eye:{type:"string",default:"left"}},init:function(){console.log("initalized stereocam"),this.layer_changed=!1},tick:function(e){var i=this.data;if(!this.layer_changed){var t;this.el.object3D.children.forEach(function(o){o.type=="PerspectiveCamera"&&(t=o)}),t?i.eye==="left"?(t.layers.enable(1),t.layers.disable(2)):i.eye==="right"?(t.layers.enable(2),t.layers.disable(1)):(t.layers.enable(1),t.layers.enable(2)):console.error("stereocam: Camera not found")}}});function L(e){const t=e.target.files[0];t&&(n.video.src=URL.createObjectURL(t))}const M=()=>{n.fileInput.click()},P=()=>{n.fileInput.addEventListener("change",L)},n={cursor:document.querySelector("#cursor"),cameraRig:document.querySelector("#cameraRig"),camRecenter:document.querySelector("#camRecenter"),cameraWrapper:document.querySelector("#cameraWrapper"),camera:document.querySelector("#camera"),video:document.querySelector("#video"),videoText:document.querySelector("#videoText"),controls:document.querySelector("#controls"),seek:document.querySelector("#seek"),timeline:document.querySelector("#timeline"),openFileBtn:document.querySelector("#openFileBtn"),seekBackwardBtn:document.querySelector("#seekBackwardBtn"),pausePlayBtn:document.querySelector("#pausePlayBtn"),seekForwardBtn:document.querySelector("#seekForwardBtn"),hideFilesBtn:document.querySelector("#hideFilesBtn"),hideUiBtn:document.querySelector("#hideUiBtn"),volIncrBtn:document.querySelector("#volIncrBtn"),volDecrBtn:document.querySelector("#volDecrBtn"),volumeTxt:document.querySelector("#volumeTxt"),toggleMode:document.querySelector("#toggleMode"),leftEye:document.querySelector("#leftEye"),rightEye:document.querySelector("#rightEye"),files:document.querySelector("#files"),loader:document.querySelector("#loader"),loaded:document.querySelector("#loaded"),filesList:document.querySelector("#filesList"),fileInput:document.querySelector("#fileInput"),CON:{HIDE_CONTROLS_TIMEOUT:5e3}};var g=!1;const x=[n.seek,n.timeline,n.seekBackwardBtn,n.pausePlayBtn,n.seekForwardBtn,n.hideUiBtn,n.openFileBtn,n.volIncrBtn,n.volDecrBtn,n.toggleMode];var w=0;const B=[{text:"180 SBS EQR",fn:()=>{n.leftEye.setAttribute("stereosphere","mode: 180SbsEq;"),n.rightEye.setAttribute("stereosphere","mode: 180SbsEq;")}},{text:"180 SBS FISH",fn:()=>{n.leftEye.setAttribute("stereosphere","mode: 180SbsFish;"),n.rightEye.setAttribute("stereosphere","mode: 180SbsFish;")}}],q=document.querySelector("a-scene");window.GS=n;function R(){{M();return}}function T(){let{openFileBtn:e,hideFilesBtn:i}=n;e.addEventListener("click",t=>R()),i.addEventListener("click",t=>void 0),P()}function $(){let{video:e,pausePlayBtn:i,seek:t,timeline:o,controls:r,hideUiBtn:s,volIncrBtn:l,volDecrBtn:c,volumeTxt:u,videoText:a,cursor:d,seekForwardBtn:b,seekBackwardBtn:f,toggleMode:h,CON:E}=n;e.src="static/sample.mp4",e.addEventListener("playing",()=>i.setAttribute("src","#asset-vp-pause")),e.addEventListener("pause",()=>i.setAttribute("src","#asset-vp-play")),i.addEventListener("click",m=>{e.paused?e.play():e.pause()}),s.addEventListener("click",m=>{r.setAttribute("visible",!1),d.setAttribute("visible",!1),n.rightEye.setAttribute("visible",!0),x.forEach(y=>y.removeAttribute("data-raycastable"))});var p=o.getAttribute("geometry").width;let{x:I,y:S,z:A}=t.getAttribute("position"),F=I-p/2;t.setAttribute("position",`${F} ${S} ${A}`),e.addEventListener("timeupdate",m=>{var y=e.currentTime/e.duration*p-p/2;t.setAttribute("position",`${y} ${S} ${A}`),a.setAttribute("text",{value:`${v(e.currentTime)}/${v(e.duration)}`})}),b.addEventListener("click",m=>{n.leftEye.setAttribute("stereosphere",{mode:"180SbsEq"}),n.rightEye.setAttribute("stereosphere",{mode:"180SbsEq"})}),f.addEventListener("click",m=>{n.leftEye.setAttribute("stereosphere",{mode:"180SbsFish"}),n.rightEye.setAttribute("stereosphere",{mode:"180SbsFish"})}),u.setAttribute("value",`${Math.round(e.volume*100)}%`),l.addEventListener("click",m=>{e.volume+.1>1?e.volume=1:e.volume+=.1,u.setAttribute("value",`${Math.round(e.volume*100)}%`)}),c.addEventListener("click",m=>{e.volume-.1<0?e.volume=0:e.volume-=.1,u.setAttribute("value",`${Math.round(e.volume*100)}%`)}),h.addEventListener("click",m=>{let{text:y,fn:k}=B[++w%B.length];n.toggleMode.setAttribute("value",y),k.call()})}function O(){let{camRecenter:e,camera:i,cameraWrapper:t,controls:o,cursor:r}=n;e.addEventListener("click",s=>{if(s.detail.intersectedEl!==n.camRecenter)return;if(!o.getAttribute("visible")){r.setAttribute("visible",!0),o.setAttribute("visible",!0),n.rightEye.setAttribute("visible",!1),x.forEach(c=>c.setAttribute("data-raycastable",!0));return}if(!g)return;let{y:l}=i.getAttribute("rotation");t.setAttribute("rotation",{x:0,y:-l,z:0})})}function z(){console.log("SETUP: Start"),O(),$(),T(),console.log("SETUP: End")}q.addEventListener("enter-vr",function(){g=!0,n.cameraRig.setAttribute("position",{x:0,y:-1.6,z:0})});q.addEventListener("exit-vr",function(){g=!1,n.cameraRig.setAttribute("position",{x:0,y:0,z:0})});
